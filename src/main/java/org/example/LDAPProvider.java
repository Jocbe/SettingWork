package org.example;

import java.util.ArrayList;
import java.util.Hashtable;
import java.util.List;

import javax.naming.Context;
import javax.naming.NamingEnumeration;
import javax.naming.NamingException;
import javax.naming.directory.Attribute;
import javax.naming.directory.Attributes;
import javax.naming.directory.DirContext;
import javax.naming.directory.InitialDirContext;
import javax.naming.directory.SearchControls;
import javax.naming.directory.SearchResult;

import org.apache.commons.codec.binary.Base64;
import org.example.models.LDAPUser;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

public class LDAPProvider {
	
	private static Logger log = LoggerFactory.getLogger(LDAPProvider.class);
	
	public static LDAPUser getUserInfo(String crsid){
		LDAPUser result = new LDAPUser();
		
		Hashtable env = new Hashtable();
		env.put(Context.INITIAL_CONTEXT_FACTORY, "com.sun.jndi.ldap.LdapCtxFactory");
		env.put(Context.PROVIDER_URL, "ldap://ldap.lookup.cam.ac.uk:389");

		Attributes a = null;
        try{
	        DirContext ctx = new InitialDirContext(env);
	        SearchControls controls = new SearchControls();
	        controls.setSearchScope(SearchControls.SUBTREE_SCOPE);
	        SearchResult searchResult = ctx.search("ou=people,o=University of Cambridge,dc=cam,dc=ac,dc=uk", "(uid="+crsid+")", controls).next();
	        a = searchResult.getAttributes();
		}catch(Exception e){
        	log.error(e.getMessage());
        	return null;
        }
       
        try {
        	log.debug("Trying to obtain data for user " + crsid);
	        result.setId(crsid);
	        log.debug("Trying to obtain displayName for user " + crsid);
	        result.setDisplayName(a.get("displayName").get().toString());
	        log.debug("Trying to obtain email address for user " + crsid);
	        result.setEmail(a.get("mail").get().toString());
	        log.debug("Trying to obtain Institutions for user " + crsid);
	        result.setInstitutions(toList(a.get("ou")));
	        log.debug("Trying to obtain roles for user " + crsid);
	        result.setRoles(toList(a.get("title")));
	        log.debug("Trying to obtain misAffiliation for user " + crsid);
	        try{
	        	if(a.get("misAffiliation").get().toString().equals("staff")) {
	        		result.setStudent(false);
	        	}
	        	log.debug("Successfully got misAffiliation");
	        } catch(NullPointerException e){
	        	log.warn("Couldn't get misAffiliation! Probably returned null. User set to role student by default.");
	        }
	        
	        log.debug("Trying to get the image for user" + crsid);
	        try{
	        	byte[] x = (byte[])a.get("jpegPhoto").get();
	        	result.setImage(new String(Base64.encodeBase64(x)));
	        }catch(NullPointerException e){
	        	result.setImage(defaultImg());
	        }
	       
        } catch (NamingException e) {
			log.error(e.getMessage());
			return result;
		}
        log.debug("Returning user info for " + crsid);
        return result;
	}
	
	private static List<String> toList(Attribute a) throws NamingException {
		log.debug("toList() called with attribute: " + a);
		if(a == null){
			log.debug("Attribute is null. Returning empty list.");
			return new ArrayList<String>();
		}
			
		NamingEnumeration enumResults = a.getAll();
		List<String> listResults = new ArrayList<String>();
		while(enumResults.hasMore()){
			listResults.add(enumResults.next().toString());
		}
		 
		log.debug("Successfully returning list of results (probably)");
		return listResults;
	}
	
	private static String defaultImg() {
		return "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";
	}
}
